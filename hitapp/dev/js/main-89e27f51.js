import{j as r,r as u}from"./react-e8886b06.js";import{u as x,a as E,P as j}from"./react-redux-28064587.js";import{c as y,l as b,a as g}from"./redux-5ef48740.js";import{t as I}from"./redux-thunk-ef899f4c.js";import"./hoist-non-react-statics-f84d2b88.js";import{F as w,I as P,S as T,M,P as _}from"./@mui-119afba8.js";import{r as O}from"./react-dom-4d145aa7.js";import"./object-assign-b33fa8b7.js";import"./@babel-531ed693.js";import"./react-is-a192e302.js";import"./clsx-1229b3e0.js";import"./@emotion-afdb9580.js";import"./stylis-79144faa.js";import"./react-transition-group-b4c1b803.js";import"./scheduler-12376d7f.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&c(n)}).observe(document,{childList:!0,subtree:!0});function l(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(e){if(e.ep)return;e.ep=!0;const s=l(e);fetch(e.href,s)}})();var i=(o=>(o.SITE="SITE",o.Elevator="Elevator",o.ElevatorClear="ElevatorClear",o))(i||{});const h={},L="",C=(o=L,t)=>{switch(t.type){case"SITE":return t.SITE;default:return o}},R=(o=h,t)=>{switch(t.type){case"Elevator":return{...o,...t.Elevator};case"ElevatorClear":return h;default:return o}},$=y({SITE:C,Elevator:R}),N=b($,g(I)),f=x,A="_ElevatorsShow_8y7os_1",B="_EachelevatorsShow_8y7os_5",D="_InputLabel_8y7os_21",m={ElevatorsShow:A,EachelevatorsShow:B,InputLabel:D};function W(o){const{title:t,options:l}=o,c=E(),{[i.SITE]:e}=f(s=>({[i.SITE]:s[i.SITE]}));return r.jsx(u.StrictMode,{children:r.jsxs(w,{fullWidth:!0,children:[r.jsx(P,{className:m.InputLabel??"",children:t}),r.jsx(T,{fullWidth:!0,onChange:s=>{c({type:i.SITE,[i.SITE]:s.target.value}),c({type:i.ElevatorClear})},value:e,children:l.map((s,n)=>r.jsx(M,{value:n,children:s},`option${n+1}`))})]})})}const q=o=>{switch(o){case"up":return"向上";case"down":return"向下";default:return"停止"}};function z(){const{[i.Elevator]:o}=f(t=>({[i.Elevator]:t[i.Elevator]}));return r.jsx(u.StrictMode,{children:r.jsx("div",{className:m.EachelevatorsShow,children:((t={})=>{const l=[];if(!Object.keys(t).length)return r.jsx("div",{children:"暂无电梯信息"});for(const c in t)if(Object.hasOwn(t,c)){const e=t[c];if(e){const{number:s}=e,n=~~(s*100/14);l.push(r.jsx("div",{children:r.jsxs(_,{elevation:3,sx:{backgroundColor:(a=>a>80?"rgb(253, 237, 237)":a>60?"rgb(255, 244, 229)":a>40?"rgb(229, 246, 253)":"rgb(237, 247, 237)")(n)},children:[r.jsxs("div",{children:["电梯编号：",c]}),r.jsxs("div",{children:["电梯状态：",e.state==="run"?"运行":"暂停"]}),r.jsxs("div",{children:["电梯方向：",q(e.direction)]}),r.jsxs("div",{children:["电梯当前楼层：",e.floor]}),r.jsxs("div",{children:["电梯人数：",s]}),r.jsxs("div",{style:{color:(a=>a>80?"rgb(95, 33, 32)":a>60?"rgb(102, 60, 0)":a>40?"rgb(1, 67, 97)":"rgb(30, 70, 32)")(n),fontWeight:"bolder"},children:[" 满载率：",`${n}%`]})]})},c))}}return r.jsx(u.StrictMode,{children:l})})(o)})})}const{random:d}=Math,F=o=>{const t={};for(let l=1;l<4;l+=1)(d()>.5||o)&&(t[l]={floor:~~(d()*10)+1,number:~~(d()*14),state:d()>.5?"run":"stop",...d()>.5&&{direction:d()>.5?"up":"down"}});return t};function J(){let o=!0;const t=E(),{[i.SITE]:l}=f(e=>({[i.SITE]:e[i.SITE]})),c=e=>!!e;return u.useEffect(()=>{const e=n=>{t({type:i.Elevator,[i.Elevator]:n})},s=()=>{const n=l!=="";if(!n)return()=>!1;const a=new EventSource(`/api/ElevatorEventSource?site=${l}`,{withCredentials:!1});return a.onmessage=function(S){const p=JSON.parse(S.data);c(p)&&e(p)},a.onerror=function(){throw e(F(o)),o=!1,setTimeout(()=>s(),(~~(d()*10)+1)*1e3),new Error("后端未连接，使用随机测试数据")},()=>{a.close()}};return s()},[t,l]),r.jsx(u.StrictMode,{})}function K(){const o=Object.freeze([{label:"主楼",elevators:[[1,2],[3,4]]},{label:"图书馆",elevators:[[1,2],[3]]}]);return r.jsxs(u.StrictMode,{children:[r.jsxs("div",{children:[r.jsx(W,{options:o.map(t=>t.label),title:"请选择地点"}),r.jsx(z,{})]}),r.jsx(J,{})]})}const U="_APP_15l9d_1",V={APP:U};function G(){return r.jsx(u.StrictMode,{children:r.jsx("div",{className:V.APP,children:r.jsx(j,{store:N,children:r.jsx(K,{})})})})}O.render(r.jsx(u.StrictMode,{children:r.jsx(G,{})}),document.body);
